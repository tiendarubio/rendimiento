<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TRRendimiento — Dependientxs</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
  <link href="assets/css/styles.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-3">
    <img src="assets/img/trlogo.png" alt="Logo" class="logo">

    <div class="header-wrap mb-3">
      <div class="header-row">
        <span class="badge-store badge-morazan">
          <i class="fa-solid fa-users"></i>
          <span>Dashboard de dependientxs</span>
        </span>
      </div>
      <div id="lastSavedHist">Histórico: aún no guardado.</div>
    </div>

    <!-- Registro rápido de venta diaria -->
    <div class="section-container mb-3">
      <h5 class="section-title mb-2">Registro rápido</h5>
      <div class="row g-3">
        <div class="col-6 col-md-3">
          <label class="form-label">Fecha</label>
          <input id="inputFecha" type="date" class="form-control">
        </div>

        <div class="col-6 col-md-3">
          <label class="form-label">Tienda</label>
          <select id="selectTienda" class="form-select">
            <option value="">Todas</option>
          </select>
        </div>

        <div class="col-12 col-md-3">
          <label class="form-label">Dependientx</label>
          <select id="selectDependientx" class="form-select">
            <option value="">Seleccione…</option>
          </select>
        </div>

        <div class="col-6 col-md-3">
          <label class="form-label">Meta diaria</label>
          <input id="inputMeta" type="number" step="0.01" class="form-control" placeholder="0.00">
        </div>

        <div class="col-6 col-md-3">
          <label class="form-label">Venta del día</label>
          <input id="inputVenta" type="number" step="0.01" class="form-control" placeholder="0.00">
        </div>

        <div class="col-12 col-md-9">
          <label class="form-label">Notas (opcional)</label>
          <input id="inputNotas" type="text" class="form-control" placeholder="Comentarios del día">
        </div>
      </div>

      <div class="d-flex flex-wrap gap-2 mt-3">
        <button id="btnAgregarRegistro" class="btn btn-primary">
          <i class="fa-solid fa-plus"></i> Registrar venta del día
        </button>
        <button id="btnGuardarHist" class="btn btn-outline-success">
          <i class="fa-solid fa-cloud-arrow-up"></i> Guardar histórico
        </button>
      </div>
    </div>

    <!-- Dashboard y consultas -->
    <div class="section-container">
      <div class="row g-3 align-items-end mb-3">
        <div class="col-6 col-md-3">
          <label class="form-label">Desde</label>
          <input id="inputDesde" type="date" class="form-control">
        </div>
        <div class="col-6 col-md-3">
          <label class="form-label">Hasta</label>
          <input id="inputHasta" type="date" class="form-control">
        </div>
        <div class="col-12 col-md-3">
          <label class="form-label">Filtro dependientx</label>
          <select id="filterDependientx" class="form-select">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col-12 col-md-3 d-flex">
          <button id="btnAplicarFiltros" class="btn btn-outline-primary w-100 mt-3 mt-md-0">
            <i class="fa-solid fa-filter"></i> Aplicar filtros
          </button>
        </div>
      </div>

      <!-- Cards de resumen -->
      <div class="dashboard-cards mb-3">
        <div class="dashboard-card">
          <div class="dashboard-card-title">Venta total</div>
          <div id="cardTotalVenta" class="dashboard-card-value">0.00</div>
          <div id="cardTotalVentaSub" class="dashboard-card-sub">En el rango seleccionado</div>
        </div>
        <div class="dashboard-card">
          <div class="dashboard-card-title">% meta global</div>
          <div id="cardPorcMeta" class="dashboard-card-value">0%</div>
          <div id="cardPorcMetaSub" class="dashboard-card-sub">Venta vs meta sumada</div>
        </div>
        <div class="dashboard-card">
          <div class="dashboard-card-title">Dependientxs que cumplen meta</div>
          <div id="cardCumplenMeta" class="dashboard-card-value">0 / 0</div>
          <div class="dashboard-card-sub">Al menos 100% de su meta promedio</div>
        </div>
      </div>

      <!-- Tabs -->
      <ul class="nav nav-tabs" id="tabsRendimiento" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab-dashboard-tab" data-bs-toggle="tab" data-bs-target="#tab-dashboard" type="button" role="tab">
            Dashboard
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-dependiente-tab" data-bs-toggle="tab" data-bs-target="#tab-dependiente" type="button" role="tab">
            Por dependientx
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-tabla-tab" data-bs-toggle="tab" data-bs-target="#tab-tabla" type="button" role="tab">
            Tabla
          </button>
        </li>
      </ul>

      <div class="tab-content pt-3">
        <!-- Tab Dashboard -->
        <div class="tab-pane fade show active" id="tab-dashboard" role="tabpanel">
          <div class="row g-3">
            <div class="col-12 col-lg-6">
              <h6 class="mb-2">Ranking por dependientx</h6>
              <div style="min-height:280px;">
                <canvas id="chartRanking"></canvas>
              </div>
            </div>
            <div class="col-12 col-lg-6">
              <h6 class="mb-2">Tendencia por día</h6>
              <div style="min-height:280px;">
                <canvas id="chartTendencia"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab por dependientx -->
        <div class="tab-pane fade" id="tab-dependiente" role="tabpanel">
          <div class="row g-3">
            <div class="col-12 col-lg-4">
              <label class="form-label">Seleccionar dependientx</label>
              <select id="detalleDependientx" class="form-select">
                <option value="">Seleccione…</option>
              </select>
            </div>
            <div class="col-12 col-lg-8">
              <h6 class="mb-2">Venta vs meta por día</h6>
              <div style="min-height:280px;">
                <canvas id="chartDetalleDependiente"></canvas>
              </div>
            </div>
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-sm table-striped" id="tablaDetalleDependiente">
              <thead class="table-light">
                <tr>
                  <th>Fecha</th>
                  <th>Tienda</th>
                  <th>Venta</th>
                  <th>Meta</th>
                  <th>% Cumplimiento</th>
                  <th>Notas</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- Tab tabla -->
        <div class="tab-pane fade" id="tab-tabla" role="tabpanel">
          <div class="table-responsive">
            <table class="table table-sm table-striped" id="tablaHistorico">
              <thead class="table-light">
                <tr>
                  <th>Fecha</th>
                  <th>Dependientx</th>
                  <th>Tienda</th>
                  <th>Venta</th>
                  <th>Meta</th>
                  <th>% Cumplimiento</th>
                  <th>Notas</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="assets/js/app.js"></script>
  <script src="assets/js/rendimiento.js"></script>
</body>
</html>
